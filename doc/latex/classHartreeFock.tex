\hypertarget{classHartreeFock}{\section{Hartree\-Fock Class Reference}
\label{classHartreeFock}\index{Hartree\-Fock@{Hartree\-Fock}}
}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classHartreeFock_ad39d695b75dc9c6aa2f0e1ff81d1adc5}{{\bfseries Hartree\-Fock} (\hyperlink{classOperator}{Operator} \&hbare)}\label{classHartreeFock_ad39d695b75dc9c6aa2f0e1ff81d1adc5}

\item 
void \hyperlink{classHartreeFock_a3d6bac9b4403e4bc599a89ad0c9b6056}{Build\-Monopole\-V} ()
\item 
void \hyperlink{classHartreeFock_a00f7b0c4cb7373a3f1a69ca27a4dfaed}{Diagonalize} ()
\item 
void \hyperlink{classHartreeFock_a84fe0eb16f6e5835c920bf8fa98c4442}{Update\-F} ()
\item 
void \hyperlink{classHartreeFock_aad38c905e7e9f9e9757b5800e6910c61}{Update\-Density\-Matrix} ()
\item 
bool \hyperlink{classHartreeFock_a35ab9c4f96e68b1c9acea1d1407ecc60}{Check\-Convergence} ()
\item 
void \hyperlink{classHartreeFock_a0666507747c17845ab4f74b97414703c}{Solve} ()
\item 
void \hyperlink{classHartreeFock_aef506c5c5bc0f317ceb9c71bdc44d62b}{Calc\-E\-H\-F} ()
\item 
void \hyperlink{classHartreeFock_a2eb6754f57250a03a2e1bd3e2aef4daf}{Reorder\-Coefficients} ()
\item 
\hyperlink{classOperator}{Operator} \hyperlink{classHartreeFock_a55914915cea16669e549025c244b62d0}{Transform\-To\-H\-F\-Basis} (\hyperlink{classOperator}{Operator} \&Op\-In)
\item 
\hyperlink{classOperator}{Operator} \hyperlink{classHartreeFock_a17bdb52033e2f62bba72ea86bc196b37}{Get\-Normal\-Ordered\-H} ()
\item 
void \hyperlink{classHartreeFock_a1c146af25a09f427cc626d877ec6e518}{Build\-Monopole\-V3} ()
\item 
\hypertarget{classHartreeFock_a7f2a07edc3ccaa0cf9bbc0faadfd9ddf}{\hyperlink{classOperator}{Operator} {\bfseries Get\-Hbare} ()}\label{classHartreeFock_a7f2a07edc3ccaa0cf9bbc0faadfd9ddf}

\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classHartreeFock_aad1a5eeadedf9689bbfc2e3d71b60aee}{\hyperlink{classOperator}{Operator} \& \hyperlink{classHartreeFock_aad1a5eeadedf9689bbfc2e3d71b60aee}{Hbare}}\label{classHartreeFock_aad1a5eeadedf9689bbfc2e3d71b60aee}

\begin{DoxyCompactList}\small\item\em Input bare Hamiltonian. \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a5d4a6814a338d7e4c17575ac74763f30}{\hyperlink{classModelSpace}{Model\-Space} $\ast$ \hyperlink{classHartreeFock_a5d4a6814a338d7e4c17575ac74763f30}{modelspace}}\label{classHartreeFock_a5d4a6814a338d7e4c17575ac74763f30}

\begin{DoxyCompactList}\small\item\em Model Space of the Hamiltonian. \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a9c73247cdb9255cebabaacc99ec55086}{arma\-::mat \hyperlink{classHartreeFock_a9c73247cdb9255cebabaacc99ec55086}{C}}\label{classHartreeFock_a9c73247cdb9255cebabaacc99ec55086}

\begin{DoxyCompactList}\small\item\em coefficients, 1st index is ho basis, 2nd = H\-F basis \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a6fc0aa9f25640979d5188443a19aeea5}{arma\-::mat \hyperlink{classHartreeFock_a6fc0aa9f25640979d5188443a19aeea5}{rho}}\label{classHartreeFock_a6fc0aa9f25640979d5188443a19aeea5}

\begin{DoxyCompactList}\small\item\em density matrix rho\-\_\-ij \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_ac0574a970910f77d873a8f2b9beb8441}{arma\-::mat \hyperlink{classHartreeFock_ac0574a970910f77d873a8f2b9beb8441}{t}}\label{classHartreeFock_ac0574a970910f77d873a8f2b9beb8441}

\begin{DoxyCompactList}\small\item\em kinetic energy \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_ae823da58505b21231d092b3ef7cec3bf}{arma\-::mat \hyperlink{classHartreeFock_ae823da58505b21231d092b3ef7cec3bf}{Vij}}\label{classHartreeFock_ae823da58505b21231d092b3ef7cec3bf}

\begin{DoxyCompactList}\small\item\em 1 body piece of 2 body potential \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a25a0f38a655064375765f74182ce9334}{arma\-::mat \hyperlink{classHartreeFock_a25a0f38a655064375765f74182ce9334}{V3ij}}\label{classHartreeFock_a25a0f38a655064375765f74182ce9334}

\begin{DoxyCompactList}\small\item\em 1 body piece of 3 body potential \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a45136295f4834a9f692f262eee75672a}{arma\-::mat \hyperlink{classHartreeFock_a45136295f4834a9f692f262eee75672a}{F}}\label{classHartreeFock_a45136295f4834a9f692f262eee75672a}

\begin{DoxyCompactList}\small\item\em Fock matrix. \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a038c93667899526e6f136695a643ad96}{arma\-::mat \hyperlink{classHartreeFock_a038c93667899526e6f136695a643ad96}{Vmon}}\label{classHartreeFock_a038c93667899526e6f136695a643ad96}

\begin{DoxyCompactList}\small\item\em Monopole 2-\/body interaction. \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a501092b930b921d0f6e8ebfb652af040}{arma\-::mat \hyperlink{classHartreeFock_a501092b930b921d0f6e8ebfb652af040}{Vmon\-\_\-exch}}\label{classHartreeFock_a501092b930b921d0f6e8ebfb652af040}

\begin{DoxyCompactList}\small\item\em Monopole 2-\/body interaction. \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a9700861effb1cb3739240b76ed519141}{arma\-::uvec \hyperlink{classHartreeFock_a9700861effb1cb3739240b76ed519141}{holeorbs}}\label{classHartreeFock_a9700861effb1cb3739240b76ed519141}

\begin{DoxyCompactList}\small\item\em list of hole orbits for generating density matrix \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a415fc1fbbba3a6a84d47e31ed18323c9}{arma\-::vec \hyperlink{classHartreeFock_a415fc1fbbba3a6a84d47e31ed18323c9}{energies}}\label{classHartreeFock_a415fc1fbbba3a6a84d47e31ed18323c9}

\begin{DoxyCompactList}\small\item\em vector of single particle energies \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a43e2a195ad044947a9e1fb9f3a937d8a}{arma\-::vec \hyperlink{classHartreeFock_a43e2a195ad044947a9e1fb9f3a937d8a}{prev\-\_\-energies}}\label{classHartreeFock_a43e2a195ad044947a9e1fb9f3a937d8a}

\begin{DoxyCompactList}\small\item\em S\-P\-E's from last iteration. \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a22c754579ad1a45f053a5305e87d4700}{double \hyperlink{classHartreeFock_a22c754579ad1a45f053a5305e87d4700}{tolerance}}\label{classHartreeFock_a22c754579ad1a45f053a5305e87d4700}

\begin{DoxyCompactList}\small\item\em tolerance for convergence \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a16c9e1791919c2ceef5584bdc9b84a81}{double \hyperlink{classHartreeFock_a16c9e1791919c2ceef5584bdc9b84a81}{E\-H\-F}}\label{classHartreeFock_a16c9e1791919c2ceef5584bdc9b84a81}

\begin{DoxyCompactList}\small\item\em Hartree-\/\-Fock energy (Normal-\/ordered 0-\/body term) \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a7658fa0b1b05dfa7bf7b8aa7e5fd6bb3}{int \hyperlink{classHartreeFock_a7658fa0b1b05dfa7bf7b8aa7e5fd6bb3}{iterations}}\label{classHartreeFock_a7658fa0b1b05dfa7bf7b8aa7e5fd6bb3}

\begin{DoxyCompactList}\small\item\em iterations used in \hyperlink{classHartreeFock_a0666507747c17845ab4f74b97414703c}{Solve()} \end{DoxyCompactList}\item 
\hypertarget{classHartreeFock_a9a552bb58da8bf501bf97003eec73830}{map$<$ array$<$ int, 6 $>$, double $>$ {\bfseries Vmon3}}\label{classHartreeFock_a9a552bb58da8bf501bf97003eec73830}

\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classHartreeFock_a3d6bac9b4403e4bc599a89ad0c9b6056}{\index{Hartree\-Fock@{Hartree\-Fock}!Build\-Monopole\-V@{Build\-Monopole\-V}}
\index{Build\-Monopole\-V@{Build\-Monopole\-V}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Build\-Monopole\-V}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Build\-Monopole\-V (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a3d6bac9b4403e4bc599a89ad0c9b6056}
Construct an unnormalized two-\/body monopole interaction \[ \langle ab | \bar{V}^{(2)} | cd \rangle = \sqrt{(1+\delta_{ab})(1+\delta_{cd})} \sum_{J} (2J+1) \langle ab | V^{(2)} | cd \rangle_{J} \] This method utilizes the operator method \hyperlink{classTwoBodyME_ac149e131002719a7394b76cd1c837bc2}{Two\-Body\-M\-E\-::\-Get\-T\-B\-M\-Emonopole()} \hypertarget{classHartreeFock_a1c146af25a09f427cc626d877ec6e518}{\index{Hartree\-Fock@{Hartree\-Fock}!Build\-Monopole\-V3@{Build\-Monopole\-V3}}
\index{Build\-Monopole\-V3@{Build\-Monopole\-V3}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Build\-Monopole\-V3}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Build\-Monopole\-V3 (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a1c146af25a09f427cc626d877ec6e518}
Construct an unnormalized three-\/body monopole interaction \[ \langle iab | \bar{V}^{(3)} | jcd \rangle = \sum\limits_{J,J_{12}}\sum_{Tt_{12}}(2J+1)(2T+1) \langle (ia)J_{12}t_{12};b JT| V^{(3)} | (jc)J_{12}t_{12}; d JT\rangle \] \hypertarget{classHartreeFock_aef506c5c5bc0f317ceb9c71bdc44d62b}{\index{Hartree\-Fock@{Hartree\-Fock}!Calc\-E\-H\-F@{Calc\-E\-H\-F}}
\index{Calc\-E\-H\-F@{Calc\-E\-H\-F}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Calc\-E\-H\-F}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Calc\-E\-H\-F (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_aef506c5c5bc0f317ceb9c71bdc44d62b}
Calculate the H\-F energy. \begin{eqnarray*} E_{HF} &=& \sum_{\alpha} t_{\alpha\alpha} + \frac{1}{2}\sum_{\alpha\beta} V_{\alpha\beta\alpha\beta} + \frac{1}{6}\sum_{\alpha\beta\gamma} V_{\alpha\beta\gamma\alpha\beta\gamma} \\ &=& \sum_{ij} (2j_i+1) \rho_{ij} ( t_{ij} +\frac{1}{2}\tilde{V}^{(2)}_{ij} + \frac{1}{6}\tilde{V}^{(3)}_{ij} ) \end{eqnarray*} Where the matrices \begin{eqnarray*} \tilde{V}^{(2)}_{ij} &=& \sum_{ab} \rho_{ab}\bar{V}^{(2)}_{iajb} \\ \tilde{V}^{(2)}_{ij} &=& \sum_{abcd} \rho_{ab}\rho_{cd} \bar{V}^{(3)}_{iacjbd} \\ \end{eqnarray*} have already been calculated by \hyperlink{classHartreeFock_a84fe0eb16f6e5835c920bf8fa98c4442}{Update\-F()}. \hypertarget{classHartreeFock_a35ab9c4f96e68b1c9acea1d1407ecc60}{\index{Hartree\-Fock@{Hartree\-Fock}!Check\-Convergence@{Check\-Convergence}}
\index{Check\-Convergence@{Check\-Convergence}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Check\-Convergence}]{\setlength{\rightskip}{0pt plus 5cm}bool Hartree\-Fock\-::\-Check\-Convergence (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a35ab9c4f96e68b1c9acea1d1407ecc60}
Check for convergence using difference in s.\-p. energies between iterations. Converged when \[ \delta_{e} \equiv \sqrt{ \sum_{i}(e_{i}^{(n)}-e_{i}^{(n-1)})^2} < \textrm{tolerance} \] where $ e_{i}^{(n)} $ is the $ i $th eigenvalue of the Fock matrix after $ n $ iterations. \hypertarget{classHartreeFock_a00f7b0c4cb7373a3f1a69ca27a4dfaed}{\index{Hartree\-Fock@{Hartree\-Fock}!Diagonalize@{Diagonalize}}
\index{Diagonalize@{Diagonalize}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Diagonalize}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Diagonalize (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a00f7b0c4cb7373a3f1a69ca27a4dfaed}
\mbox{[}See Suhonen eq. 4.\-85\mbox{]} Diagonalize the fock matrix $ <a|F|b> $ and put the eigenvectors in $C(i,\alpha) = <i|\alpha> $ and eigenvalues in the vector energies. Save the last vector of energies to check for convergence. Different channels are diagonalized independently. This guarantees that J,Tz, and $ \pi $ remain good. \hypertarget{classHartreeFock_a17bdb52033e2f62bba72ea86bc196b37}{\index{Hartree\-Fock@{Hartree\-Fock}!Get\-Normal\-Ordered\-H@{Get\-Normal\-Ordered\-H}}
\index{Get\-Normal\-Ordered\-H@{Get\-Normal\-Ordered\-H}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Get\-Normal\-Ordered\-H}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Operator} Hartree\-Fock\-::\-Get\-Normal\-Ordered\-H (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a17bdb52033e2f62bba72ea86bc196b37}
Returns the normal-\/ordered Hamiltonian in the Hartree-\/\-Fock basis \[ E_0 = E_{HF} \] \[ f_{ij} = C^{\dagger} F_{ij} C \] \[ \Gamma^{J}_{ijkl} = D^{\dagger} \left[V^{J}_{ijkl} + \sum_{ab}\sum_{J_3}(2J_{3}+1)\rho_{ab}V^{JJJ_{3}}_{ijaklb}\right] D \] Where the matrix $ D$ is the same as the one defined in \hyperlink{classHartreeFock_a55914915cea16669e549025c244b62d0}{Transform\-To\-H\-F\-Basis()}. \hypertarget{classHartreeFock_a2eb6754f57250a03a2e1bd3e2aef4daf}{\index{Hartree\-Fock@{Hartree\-Fock}!Reorder\-Coefficients@{Reorder\-Coefficients}}
\index{Reorder\-Coefficients@{Reorder\-Coefficients}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Reorder\-Coefficients}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Reorder\-Coefficients (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a2eb6754f57250a03a2e1bd3e2aef4daf}
Eigenvectors/values come out of the diagonalization energy-\/ordered. We want them ordered corresponding to the input ordering, i.\-e. we want the matrix C to be maximal and positive along the diagonal. For a 3x3 matrix this would be something like \[ \left( \begin{array}{rrr} -0.8 & 0.2 & -0.6 \\ -0.3 & 0.3 & 0.9 \\ 0.2 & 0.9 & -0.4 \\ \end{array}\right) \rightarrow \left(\begin{array}{rrr} 0.8 & -0.6 & 0.2 \\ 0.3 & 0.9 & 0.3 \\ -0.2 & -0.4 & 0.9 \\ \end{array}\right) \] \hypertarget{classHartreeFock_a0666507747c17845ab4f74b97414703c}{\index{Hartree\-Fock@{Hartree\-Fock}!Solve@{Solve}}
\index{Solve@{Solve}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Solve}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Solve (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a0666507747c17845ab4f74b97414703c}
Diagonalize and update the Fock matrix until convergence. Then, call \hyperlink{classHartreeFock_a2eb6754f57250a03a2e1bd3e2aef4daf}{Reorder\-Coefficients()} to make sure the index ordering and phases are preserved in the transformation from the original basis to the Hatree-\/\-Fock basis. \hypertarget{classHartreeFock_a55914915cea16669e549025c244b62d0}{\index{Hartree\-Fock@{Hartree\-Fock}!Transform\-To\-H\-F\-Basis@{Transform\-To\-H\-F\-Basis}}
\index{Transform\-To\-H\-F\-Basis@{Transform\-To\-H\-F\-Basis}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Transform\-To\-H\-F\-Basis}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Operator} Hartree\-Fock\-::\-Transform\-To\-H\-F\-Basis (
\begin{DoxyParamCaption}
\item[{{\bf Operator} \&}]{Op\-In}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a55914915cea16669e549025c244b62d0}
Takes in an operator expressed in the basis of the original Hamiltonian, and returns that operator in the Hartree-\/\-Fock basis. \[ t_{HF} = C^{\dagger} t_{HO} C \] \[ V_{HF}^{J} = D^{\dagger} V^{J}_{HO} D \] The matrix $ D $ is defined as \[ D_{ab\alpha\beta} \equiv \sqrt{ \frac{1+\delta_{ab}} {1+\delta_{\alpha\beta}} } C_{a\alpha} C_{b\beta} \] The factor in the square root is due to the fact that we're using normalized T\-B\-M\-E's. Since only kets with $ a\leq b$ are stored, we can use the antisymmetry of the T\-B\-M\-E's and define \[ D(J)_{ab\alpha\beta} \equiv \sqrt{ \frac{1+\delta_{ab}} {1+\delta_{\alpha\beta}} } \left( C_{a\alpha} C_{b\beta} -(1-\delta_{ab})(-1)^{j_a+j_b-J} C_{b\alpha}C_{a\beta}\right) \] \hypertarget{classHartreeFock_aad38c905e7e9f9e9757b5800e6910c61}{\index{Hartree\-Fock@{Hartree\-Fock}!Update\-Density\-Matrix@{Update\-Density\-Matrix}}
\index{Update\-Density\-Matrix@{Update\-Density\-Matrix}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Update\-Density\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Update\-Density\-Matrix (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_aad38c905e7e9f9e9757b5800e6910c61}
one-\/body density matrix $ <i|\rho|j> = \sum\limits_{\beta} n_{\beta} <i|\beta> <\beta|j> $ where $n_{\beta} $ ensureas that beta runs over H\-F orbits in the core (i.\-e. below the fermi surface) \hypertarget{classHartreeFock_a84fe0eb16f6e5835c920bf8fa98c4442}{\index{Hartree\-Fock@{Hartree\-Fock}!Update\-F@{Update\-F}}
\index{Update\-F@{Update\-F}!HartreeFock@{Hartree\-Fock}}
\subsubsection[{Update\-F}]{\setlength{\rightskip}{0pt plus 5cm}void Hartree\-Fock\-::\-Update\-F (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classHartreeFock_a84fe0eb16f6e5835c920bf8fa98c4442}
\mbox{[}See Suhonen eq 4.\-85\mbox{]} \[ F_{ij} = t_{ij} + \frac{1}{2j_i+1}\sum_{ab} \rho_{ab} \bar{V}^{(2)}_{iajb} + \frac{1}{2(2j_i+1)}\sum_{abcd}\rho_{ab} \rho_{cd} \bar{V}^{(3)}_{iacjbd} \]
\begin{DoxyItemize}
\item $ F $ is the Fock matrix, to be diagonalized
\item $ t $ is the kinetic energy
\item $\rho$ is the density matrix defined in \hyperlink{classHartreeFock_aad38c905e7e9f9e9757b5800e6910c61}{Update\-Density\-Matrix()}
\item $ \bar{V}^{(2)} $ is the monopole component of the 2-\/body interaction defined in \hyperlink{classHartreeFock_a3d6bac9b4403e4bc599a89ad0c9b6056}{Build\-Monopole\-V()}.
\item $ \bar{V}^{(3)} $ is the monopole component of the 3-\/body interaction devined in \hyperlink{classHartreeFock_a1c146af25a09f427cc626d877ec6e518}{Build\-Monopole\-V3()}. 
\end{DoxyItemize}

The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
Hartree\-Fock.\-hh\item 
Hartree\-Fock.\-cc\end{DoxyCompactItemize}
